<div class="workspace-panel" id="workspacePanel" data-collapsed="false">
    <div class="workspace-header">
        <div class="workspace-header-title">
            <button class="workspace-collapse-btn btn btn-sm btn-outline-light" type="button" id="workspaceToggleBtn" aria-expanded="true" title="Collapse workspace">
                <i class="bi bi-chevron-right"></i>
            </button>
            <div>
                <h5><i class="bi bi-folder2-open me-2"></i>Project Workspace</h5>
                <small>Code together in real-time</small>
            </div>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-sm btn-outline-light" data-workspace-create="python" title="New Python file" {% if not workspace_key %}disabled{% endif %}>.py</button>
            <button class="btn btn-sm btn-outline-light" data-workspace-create="html" title="New HTML file" {% if not workspace_key %}disabled{% endif %}>.html</button>
        </div>
    </div>
    <div class="workspace-body">
        {% if workspace_key %}
        <div class="workspace-file-list" id="workspace-file-list">
            <div class="p-3 text-center text-muted small">
                <i class="bi bi-files"></i> No files yet
            </div>
        </div>
        <div class="workspace-editor" id="workspace-editor-wrapper">
            <div class="workspace-editor-bar">
                <div>
                    <strong id="workspace-active-file">Select a file</strong>
                    <span class="badge ms-2 d-none" id="workspace-language"></span>
                </div>
                <div class="workspace-editor-actions">
                    <button type="button" id="workspace-rename-btn" title="Rename file" disabled><i class="bi bi-pencil"></i></button>
                    <button type="button" id="workspace-delete-btn" title="Delete file" disabled><i class="bi bi-trash"></i></button>
                </div>
            </div>
            <textarea id="workspace-editor" placeholder="Pick a file from the list to start editing." disabled></textarea>
            <div class="workspace-editor-controls">
                <button class="btn btn-outline-light" id="workspace-download-btn" disabled>
                    <i class="bi bi-download me-1"></i>Download
                </button>
                <button class="btn btn-primary" id="workspace-run-btn" disabled>
                    <i class="bi bi-play-fill me-1"></i>Run
                </button>
            </div>
            <div class="workspace-output">
                <div class="workspace-output-header">
                    <h6 class="mb-0">Interpreter Output</h6>
                    <small id="workspace-output-meta" class="text-secondary"></small>
                </div>
                <pre id="workspace-console" class="mb-0 text-white" style="min-height: 110px;">Select a file and press Run to see output.</pre>
                <iframe id="workspace-preview" class="workspace-preview d-none"></iframe>
            </div>
        </div>
        {% else %}
        <div class="workspace-locked">
            <div>
                <i class="bi bi-braces"></i>
                <h6>Select a conversation</h6>
                <p>Open any chat to unlock the collaborative workspace.</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>

